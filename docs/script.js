// Функция для упрощения создание элементов.
var arrows, carousel, carouselContainer, createElem, createScheduleList, currentStepWidth, firstSlide, itemWidth, itemsScrolled, lastSlide, numberOfSteps, pushSlider, referToJson, todayDate, updateDayProgram;

createElem = function(tag, elemClass) {
  var elem;
  elem = document.createElement(tag);
  elem.classList.add(elemClass);
  return elem;
};


// Здесь нужно будет подтягивать актуальную дату.
todayDate = '2020-05-25';

// Обращаемся к json-файлу
referToJson = function(callback) {
  fetch('test.json', {
    method: 'get'
  }).then(function(response) {
    return response.json();
  }).then(function(schedule) {
    return callback(schedule);
  }).catch(function(err) {
    return console.log(err);
  });
};

createScheduleList = function(schedule) {
  var date, dayNumber, dayWeek, key, mounth, registerEvents, scheduleContainer, scheduleDay, scheduleItem, scheduleLine, scheduleMounth, scheduleWeekday;
  scheduleContainer = document.querySelector('.tv-widget__schedule-items');
// Создаём расписание 
  for (key in schedule) {
    moment.locale('ru');
    date = moment(key);
    dayNumber = date.format('DD');
    mounth = date.format('MMMM');
    dayWeek = date.format('dd');
    scheduleItem = createElem('div', 'tv-widget__schedule-item');
    scheduleItem.dataset.date = key;
    if (dayWeek === 'сб' || dayWeek === 'вс') {
      scheduleItem.classList.add('tv-widget__schedule-item_weekend');
    } else if (dayWeek === 'пт') {
      scheduleItem.classList.add('tv-widget__schedule-item_friday');
    }
    scheduleDay = createElem('div', 'tv-widget__day');
    scheduleDay.textContent = dayNumber;
    scheduleMounth = createElem('div', 'tv-widget__mounth');
    scheduleMounth.textContent = mounth;
    scheduleLine = createElem('div', 'tv-widget__line');
    scheduleWeekday = createElem('div', 'tv-widget__weekday');
    scheduleWeekday.textContent = dayWeek;
    scheduleItem.appendChild(scheduleDay);
    scheduleItem.appendChild(scheduleMounth);
    scheduleItem.appendChild(scheduleLine);
    scheduleItem.appendChild(scheduleWeekday);
    scheduleContainer.appendChild(scheduleItem);
  }
  // Обновляем элементы при загрузке страницы
  updateDayProgram(todayDate, schedule[todayDate]);
  // Регистрируем события
  registerEvents = function() {
    var scheduleDays;
    scheduleDays = Array.from(document.querySelectorAll('.tv-widget__schedule-item'));
    scheduleDays.forEach(function(item) {
      item.addEventListener('click', function(event) {
        var elem;
        elem = event.target.closest('.tv-widget__schedule-item');
        updateDayProgram(elem.getAttribute('data-date'), schedule[elem.getAttribute('data-date')]);
      });
    });
  };
  registerEvents();
};

// Обновляем элементы расписания под календарём
updateDayProgram = function(date, schedule) {
  var programContainer, widgetTitleSpan, widgetTitleSpanText;
  widgetTitleSpan = document.querySelector('.tv_widget__today-date');
  widgetTitleSpanText = moment(date).format('dddd, DD MMMM YYYY');
  if (date === todayDate) {
    widgetTitleSpan.textContent = ' на сегодня';
  } else {
    widgetTitleSpan.textContent = '';
  }
  widgetTitleSpan.textContent += '. ' + widgetTitleSpanText[0].toUpperCase() + widgetTitleSpanText.slice(1);
  programContainer = document.querySelector('.tv-widget__program-cards');
  programContainer.innerHTML = '';
  schedule.forEach(function(item, index) {
    var award, awards, button, buttonBlock, channelImg, countryImg, key, liveTitle, programArtists, programCard, programCountry, programDescription, programTime, programTitle, titleBlock, tvChannel;
    programCard = createElem('div', 'tv-widget__program-card');
    titleBlock = createElem('div', 'tv-widget__program-title-block');
    programTime = createElem('div', 'tv-widget__program-time');
    programTime.textContent = item.time;
    programTitle = createElem('a', 'tv-widget__program-title');
    programTitle.href = '#';
    programTitle.textContent = item.title;
    awards = createElem('div', 'tv-widget__program-awards');
    for (key in item.awards) {
      if (item.awards[key] === 'true') {
        award = createElem('div', 'tv-widget__program-award');
        award.classList.add('tv-widget__program-award_' + key);
        awards.appendChild(award);
      }
    }
    programCountry = createElem('div', 'tv-widget__program-country');
    countryImg = document.createElement('img');
    countryImg.src = 'img/icons/russia-icon.svg';
    countryImg.alt = item.country;
    programCountry.appendChild(countryImg);
    tvChannel = createElem('div', 'tv-widget__program-channel');
    channelImg = document.createElement('img');
    channelImg.src = 'img/icons/1tv-icon.svg';
    channelImg.alt = item.channel;
    tvChannel.appendChild(channelImg);
    titleBlock.appendChild(programTime);
    titleBlock.appendChild(programTitle);
    titleBlock.appendChild(awards);
    if (item.country) {
      titleBlock.appendChild(programCountry);
    }
    titleBlock.appendChild(tvChannel);
    programDescription = createElem('div', 'tv-widget__program-description');
    programDescription.textContent = item.description;
    programArtists = createElem('div', 'tv-widget__program-artists');
    item.artists.forEach(function(artistName, index) {
      var artistElem;
      artistElem = createElem('a', 'tv-widget__program-artist');
      artistElem.href = '#';
      artistElem.textContent = artistName;
      programArtists.appendChild(artistElem);
      if (index !== item.artists.length - 1) {
        programArtists.innerHTML += ', ';
      }
    });
    programCard.appendChild(titleBlock);
    programCard.appendChild(programDescription);
    programCard.appendChild(programArtists);
    // Тут нужно указать текущие время и дату. Используется для показа кнопок "Смотреть" и "Сейчас в эфире"
    if (moment(date).format('L') === moment(todayDate).format('L') && item.time === '10:59') {
      buttonBlock = createElem('div', 'tv-widget__button-block');
      button = createElem('div', 'look-button');
      button.textContent = 'Смотреть';
      liveTitle = createElem('div', 'tv-widget__life-now');
      liveTitle.textContent = 'Сейчас в эфире';
      buttonBlock.appendChild(button);
      buttonBlock.appendChild(liveTitle);
      programCard.appendChild(buttonBlock);
    }
    programContainer.appendChild(programCard);
  });
};

// слайдер
arrows = document.querySelectorAll('.tv-widget__arrow-circle');

carouselContainer = document.querySelector('.tv-widget__schedule-corousel');

carousel = document.querySelector('.tv-widget__schedule-items');

firstSlide = true;

lastSlide = false;

itemWidth = 84; // Ширина элемента

numberOfSteps = void 0; // Количество шагов, которое предстоит сделать 

currentStepWidth = 60; // Изначальное остояние left 

itemsScrolled = 0; //Количество элементов, которые мы скроллим

pushSlider = function(direction = 'right') {
  var containerWidth, itemsNumber, remainedToScroll, slideWidth;
  itemsNumber = document.querySelectorAll('.tv-widget__schedule-item').length; // Общее количество элементов
  containerWidth = carouselContainer.offsetWidth; // Ширина контейнера
  
      // В зависимости от ширины контейнера определяем, сколько элементов надо прокрутить
  switch (true) {
    case containerWidth < 360:
      numberOfSteps = 1;
      break;
    case containerWidth < 420:
      numberOfSteps = 2;
      break;
    case containerWidth < 505:
      numberOfSteps = 3;
      break;
    case containerWidth < 585:
      numberOfSteps = 4;
      break;
    default:
      numberOfSteps = 5;
  }
  // Определяем, сколько элементов предстоить прокрутить. 
  remainedToScroll = itemsNumber - itemsScrolled - numberOfSteps - 2;
  if (direction === 'right') {
    if (remainedToScroll < numberOfSteps) { // Если количество элементов, сколько можно прокрутить, меньше количества шагов
      numberOfSteps = remainedToScroll; // Говорим, сколько шагов прокручиваем
      lastSlide = true; // Определяем, что слайд последний
    }
  }
  slideWidth = itemWidth * numberOfSteps; // Определяем ширину слайда (насколько нужно прокрутить)
  if (direction === 'right') {
    currentStepWidth -= slideWidth;
    itemsScrolled += numberOfSteps;
    if (lastSlide && remainedToScroll !== 0) {
      currentStepWidth = -1 * itemWidth * itemsNumber + containerWidth - 40;
    }
    if (firstSlide) {
      currentStepWidth += itemWidth;
      currentStepWidth -= 60;
      firstSlide = false; // Если прокручиваем влево
    }
  } else {
    currentStepWidth += slideWidth;
    itemsScrolled -= numberOfSteps;
    if (itemsScrolled <= 0) {
      currentStepWidth = 60; // возвращаемся в изначальню первую позицию
      itemsScrolled = 0;
      firstSlide = true;
    }
    if (lastSlide) {
      lastSlide = false;
    }
  }
  carousel.style.left = currentStepWidth.toString() + 'px';
};

Array.from(arrows).forEach(function(item) {
  item.addEventListener('click', function(event) {
    if (event.target.parentElement.classList.contains('tv-widget__arrow-circle_right')) {
      pushSlider();
    } else {
      pushSlider('left');
    }
  });
});

// Создаём календарь
referToJson(createScheduleList);

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjaGVkdWxlLWNhcm91c2VsLmNvZmZlZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBMkM7QUFBQSxJQUFBLE1BQUEsRUFBQSxRQUFBLEVBQUEsaUJBQUEsRUFBQSxVQUFBLEVBQUEsa0JBQUEsRUFBQSxnQkFBQSxFQUFBLFVBQUEsRUFBQSxTQUFBLEVBQUEsYUFBQSxFQUFBLFNBQUEsRUFBQSxhQUFBLEVBQUEsVUFBQSxFQUFBLFdBQUEsRUFBQSxTQUFBLEVBQUE7O0FBQzNDLFVBQUEsR0FBYSxRQUFBLENBQUMsR0FBRCxFQUFNLFNBQU4sQ0FBQTtBQUNiLE1BQUE7RUFBRSxJQUFBLEdBQU8sUUFBUSxDQUFDLGFBQVQsQ0FBdUIsR0FBdkI7RUFDUCxJQUFJLENBQUMsU0FBUyxDQUFDLEdBQWYsQ0FBbUIsU0FBbkI7U0FDQTtBQUhXLEVBRDhCOzs7O0FBTzNDLFNBQUEsR0FBWSxhQVArQjs7O0FBVTNDLFdBQUEsR0FBYyxRQUFBLENBQUMsUUFBRCxDQUFBO0VBQ1osS0FBQSxDQUFNLFdBQU4sRUFBbUI7SUFBQSxNQUFBLEVBQVE7RUFBUixDQUFuQixDQUFpQyxDQUFDLElBQWxDLENBQXVDLFFBQUEsQ0FBQyxRQUFELENBQUE7V0FDckMsUUFBUSxDQUFDLElBQVQsQ0FBQTtFQURxQyxDQUF2QyxDQUVDLENBQUMsSUFGRixDQUVPLFFBQUEsQ0FBQyxRQUFELENBQUE7V0FDTCxRQUFBLENBQVMsUUFBVDtFQURLLENBRlAsQ0FJQyxDQUFDLEtBSkYsQ0FJUSxRQUFBLENBQUMsR0FBRCxDQUFBO1dBQ04sT0FBTyxDQUFDLEdBQVIsQ0FBWSxHQUFaO0VBRE0sQ0FKUjtBQURZOztBQVNkLGtCQUFBLEdBQXFCLFFBQUEsQ0FBQyxRQUFELENBQUE7QUFDckIsTUFBQSxJQUFBLEVBQUEsU0FBQSxFQUFBLE9BQUEsRUFBQSxHQUFBLEVBQUEsTUFBQSxFQUFBLGNBQUEsRUFBQSxpQkFBQSxFQUFBLFdBQUEsRUFBQSxZQUFBLEVBQUEsWUFBQSxFQUFBLGNBQUEsRUFBQTtFQUFFLGlCQUFBLEdBQW9CLFFBQVEsQ0FBQyxhQUFULENBQXVCLDRCQUF2QixFQUF0Qjs7RUFHRSxLQUFBLGVBQUE7SUFDRSxNQUFNLENBQUMsTUFBUCxDQUFjLElBQWQ7SUFDQSxJQUFBLEdBQU8sTUFBQSxDQUFPLEdBQVA7SUFDUCxTQUFBLEdBQVksSUFBSSxDQUFDLE1BQUwsQ0FBWSxJQUFaO0lBQ1osTUFBQSxHQUFTLElBQUksQ0FBQyxNQUFMLENBQVksTUFBWjtJQUNULE9BQUEsR0FBVSxJQUFJLENBQUMsTUFBTCxDQUFZLElBQVo7SUFDVixZQUFBLEdBQWUsVUFBQSxDQUFXLEtBQVgsRUFBa0IsMEJBQWxCO0lBQ2YsWUFBWSxDQUFDLE9BQU8sQ0FBQyxJQUFyQixHQUE0QjtJQUU1QixJQUFHLE9BQUEsS0FBVyxJQUFYLElBQW1CLE9BQUEsS0FBVyxJQUFqQztNQUNFLFlBQVksQ0FBQyxTQUFTLENBQUMsR0FBdkIsQ0FBMkIsa0NBQTNCLEVBREY7S0FBQSxNQUVLLElBQUcsT0FBQSxLQUFXLElBQWQ7TUFDSCxZQUFZLENBQUMsU0FBUyxDQUFDLEdBQXZCLENBQTJCLGlDQUEzQixFQURHOztJQUdMLFdBQUEsR0FBYyxVQUFBLENBQVcsS0FBWCxFQUFrQixnQkFBbEI7SUFDZCxXQUFXLENBQUMsV0FBWixHQUEwQjtJQUUxQixjQUFBLEdBQWlCLFVBQUEsQ0FBVyxLQUFYLEVBQWtCLG1CQUFsQjtJQUNqQixjQUFjLENBQUMsV0FBZixHQUE2QjtJQUU3QixZQUFBLEdBQWUsVUFBQSxDQUFXLEtBQVgsRUFBa0IsaUJBQWxCO0lBRWYsZUFBQSxHQUFrQixVQUFBLENBQVcsS0FBWCxFQUFrQixvQkFBbEI7SUFDbEIsZUFBZSxDQUFDLFdBQWhCLEdBQThCO0lBRTlCLFlBQVksQ0FBQyxXQUFiLENBQXlCLFdBQXpCO0lBQ0EsWUFBWSxDQUFDLFdBQWIsQ0FBeUIsY0FBekI7SUFDQSxZQUFZLENBQUMsV0FBYixDQUF5QixZQUF6QjtJQUNBLFlBQVksQ0FBQyxXQUFiLENBQXlCLGVBQXpCO0lBRUEsaUJBQWlCLENBQUMsV0FBbEIsQ0FBOEIsWUFBOUI7RUE5QkYsQ0FIRjs7RUFvQ0UsZ0JBQUEsQ0FBaUIsU0FBakIsRUFBNEIsUUFBUSxDQUFDLFNBQUQsQ0FBcEMsRUFwQ0Y7O0VBdUNFLGNBQUEsR0FBaUIsUUFBQSxDQUFBLENBQUE7QUFDbkIsUUFBQTtJQUFJLFlBQUEsR0FBZSxLQUFLLENBQUMsSUFBTixDQUFXLFFBQVEsQ0FBQyxnQkFBVCxDQUEwQiwyQkFBMUIsQ0FBWDtJQUNmLFlBQVksQ0FBQyxPQUFiLENBQXFCLFFBQUEsQ0FBQyxJQUFELENBQUE7TUFDbkIsSUFBSSxDQUFDLGdCQUFMLENBQXNCLE9BQXRCLEVBQStCLFFBQUEsQ0FBQyxLQUFELENBQUE7QUFDckMsWUFBQTtRQUFRLElBQUEsR0FBTyxLQUFLLENBQUMsTUFBTSxDQUFDLE9BQWIsQ0FBcUIsMkJBQXJCO1FBQ1AsZ0JBQUEsQ0FBaUIsSUFBSSxDQUFDLFlBQUwsQ0FBa0IsV0FBbEIsQ0FBakIsRUFBaUQsUUFBUSxDQUFDLElBQUksQ0FBQyxZQUFMLENBQWtCLFdBQWxCLENBQUQsQ0FBekQ7TUFGNkIsQ0FBL0I7SUFEbUIsQ0FBckI7RUFGZTtFQVVqQixjQUFBLENBQUE7QUFsRG1CLEVBbkJzQjs7O0FBeUUzQyxnQkFBQSxHQUFtQixRQUFBLENBQUMsSUFBRCxFQUFPLFFBQVAsQ0FBQTtBQUNuQixNQUFBLGdCQUFBLEVBQUEsZUFBQSxFQUFBO0VBQUUsZUFBQSxHQUFrQixRQUFRLENBQUMsYUFBVCxDQUF1Qix3QkFBdkI7RUFDbEIsbUJBQUEsR0FBc0IsTUFBQSxDQUFPLElBQVAsQ0FBWSxDQUFDLE1BQWIsQ0FBb0Isb0JBQXBCO0VBRXRCLElBQUcsSUFBQSxLQUFRLFNBQVg7SUFDRSxlQUFlLENBQUMsV0FBaEIsR0FBOEIsY0FEaEM7R0FBQSxNQUFBO0lBR0UsZUFBZSxDQUFDLFdBQWhCLEdBQThCLEdBSGhDOztFQUlBLGVBQWUsQ0FBQyxXQUFoQixJQUErQixJQUFBLEdBQU8sbUJBQW1CLENBQUMsQ0FBRCxDQUFHLENBQUMsV0FBdkIsQ0FBQSxDQUFQLEdBQThDLG1CQUFtQixDQUFDLEtBQXBCLENBQTBCLENBQTFCO0VBRTdFLGdCQUFBLEdBQW1CLFFBQVEsQ0FBQyxhQUFULENBQXVCLDJCQUF2QjtFQUNuQixnQkFBZ0IsQ0FBQyxTQUFqQixHQUE2QjtFQUU3QixRQUFRLENBQUMsT0FBVCxDQUFpQixRQUFBLENBQUMsSUFBRCxFQUFPLEtBQVAsQ0FBQTtBQUNuQixRQUFBLEtBQUEsRUFBQSxNQUFBLEVBQUEsTUFBQSxFQUFBLFdBQUEsRUFBQSxVQUFBLEVBQUEsVUFBQSxFQUFBLEdBQUEsRUFBQSxTQUFBLEVBQUEsY0FBQSxFQUFBLFdBQUEsRUFBQSxjQUFBLEVBQUEsa0JBQUEsRUFBQSxXQUFBLEVBQUEsWUFBQSxFQUFBLFVBQUEsRUFBQTtJQUFJLFdBQUEsR0FBYyxVQUFBLENBQVcsS0FBWCxFQUFrQix5QkFBbEI7SUFDZCxVQUFBLEdBQWEsVUFBQSxDQUFXLEtBQVgsRUFBa0IsZ0NBQWxCO0lBQ2IsV0FBQSxHQUFjLFVBQUEsQ0FBVyxLQUFYLEVBQWtCLHlCQUFsQjtJQUNkLFdBQVcsQ0FBQyxXQUFaLEdBQTBCLElBQUksQ0FBQztJQUMvQixZQUFBLEdBQWUsVUFBQSxDQUFXLEdBQVgsRUFBZ0IsMEJBQWhCO0lBQ2YsWUFBWSxDQUFDLElBQWIsR0FBb0I7SUFDcEIsWUFBWSxDQUFDLFdBQWIsR0FBMkIsSUFBSSxDQUFDO0lBQ2hDLE1BQUEsR0FBUyxVQUFBLENBQVcsS0FBWCxFQUFrQiwyQkFBbEI7SUFFVCxLQUFBLGtCQUFBO01BQ0UsSUFBRyxJQUFJLENBQUMsTUFBTSxDQUFDLEdBQUQsQ0FBWCxLQUFvQixNQUF2QjtRQUNFLEtBQUEsR0FBUSxVQUFBLENBQVcsS0FBWCxFQUFrQiwwQkFBbEI7UUFDUixLQUFLLENBQUMsU0FBUyxDQUFDLEdBQWhCLENBQW9CLDJCQUFBLEdBQThCLEdBQWxEO1FBQ0EsTUFBTSxDQUFDLFdBQVAsQ0FBbUIsS0FBbkIsRUFIRjs7SUFERjtJQU1BLGNBQUEsR0FBaUIsVUFBQSxDQUFXLEtBQVgsRUFBa0IsNEJBQWxCO0lBRWpCLFVBQUEsR0FBYSxRQUFRLENBQUMsYUFBVCxDQUF1QixLQUF2QjtJQUNiLFVBQVUsQ0FBQyxHQUFYLEdBQWlCO0lBQ2pCLFVBQVUsQ0FBQyxHQUFYLEdBQWlCLElBQUksQ0FBQztJQUV0QixjQUFjLENBQUMsV0FBZixDQUEyQixVQUEzQjtJQUNBLFNBQUEsR0FBWSxVQUFBLENBQVcsS0FBWCxFQUFrQiw0QkFBbEI7SUFFWixVQUFBLEdBQWEsUUFBUSxDQUFDLGFBQVQsQ0FBdUIsS0FBdkI7SUFDYixVQUFVLENBQUMsR0FBWCxHQUFpQjtJQUNqQixVQUFVLENBQUMsR0FBWCxHQUFpQixJQUFJLENBQUM7SUFFdEIsU0FBUyxDQUFDLFdBQVYsQ0FBc0IsVUFBdEI7SUFDQSxVQUFVLENBQUMsV0FBWCxDQUF1QixXQUF2QjtJQUNBLFVBQVUsQ0FBQyxXQUFYLENBQXVCLFlBQXZCO0lBQ0EsVUFBVSxDQUFDLFdBQVgsQ0FBdUIsTUFBdkI7SUFFQSxJQUFHLElBQUksQ0FBQyxPQUFSO01BQ0UsVUFBVSxDQUFDLFdBQVgsQ0FBdUIsY0FBdkIsRUFERjs7SUFHQSxVQUFVLENBQUMsV0FBWCxDQUF1QixTQUF2QjtJQUVBLGtCQUFBLEdBQXFCLFVBQUEsQ0FBVyxLQUFYLEVBQWtCLGdDQUFsQjtJQUNyQixrQkFBa0IsQ0FBQyxXQUFuQixHQUFpQyxJQUFJLENBQUM7SUFFdEMsY0FBQSxHQUFpQixVQUFBLENBQVcsS0FBWCxFQUFrQiw0QkFBbEI7SUFFakIsSUFBSSxDQUFDLE9BQU8sQ0FBQyxPQUFiLENBQXFCLFFBQUEsQ0FBQyxVQUFELEVBQWEsS0FBYixDQUFBO0FBQ3pCLFVBQUE7TUFBTSxVQUFBLEdBQWEsVUFBQSxDQUFXLEdBQVgsRUFBZ0IsMkJBQWhCO01BQ2IsVUFBVSxDQUFDLElBQVgsR0FBa0I7TUFDbEIsVUFBVSxDQUFDLFdBQVgsR0FBeUI7TUFDekIsY0FBYyxDQUFDLFdBQWYsQ0FBMkIsVUFBM0I7TUFFQSxJQUFHLEtBQUEsS0FBUyxJQUFJLENBQUMsT0FBTyxDQUFDLE1BQWIsR0FBc0IsQ0FBbEM7UUFDRSxjQUFjLENBQUMsU0FBZixJQUE0QixLQUQ5Qjs7SUFObUIsQ0FBckI7SUFVQSxXQUFXLENBQUMsV0FBWixDQUF3QixVQUF4QjtJQUNBLFdBQVcsQ0FBQyxXQUFaLENBQXdCLGtCQUF4QjtJQUNBLFdBQVcsQ0FBQyxXQUFaLENBQXdCLGNBQXhCLEVBdkRKOztJQTBESSxJQUFHLE1BQUEsQ0FBTyxJQUFQLENBQVksQ0FBQyxNQUFiLENBQW9CLEdBQXBCLENBQUEsS0FBNEIsTUFBQSxDQUFPLFNBQVAsQ0FBaUIsQ0FBQyxNQUFsQixDQUF5QixHQUF6QixDQUE1QixJQUE4RCxJQUFJLENBQUMsSUFBTCxLQUFhLE9BQTlFO01BRUUsV0FBQSxHQUFjLFVBQUEsQ0FBVyxLQUFYLEVBQWtCLHlCQUFsQjtNQUNkLE1BQUEsR0FBUyxVQUFBLENBQVcsS0FBWCxFQUFrQixhQUFsQjtNQUNULE1BQU0sQ0FBQyxXQUFQLEdBQXFCO01BRXJCLFNBQUEsR0FBWSxVQUFBLENBQVcsS0FBWCxFQUFrQixxQkFBbEI7TUFDWixTQUFTLENBQUMsV0FBVixHQUF3QjtNQUV4QixXQUFXLENBQUMsV0FBWixDQUF3QixNQUF4QjtNQUNBLFdBQVcsQ0FBQyxXQUFaLENBQXdCLFNBQXhCO01BQ0EsV0FBVyxDQUFDLFdBQVosQ0FBd0IsV0FBeEIsRUFYRjs7SUFhQSxnQkFBZ0IsQ0FBQyxXQUFqQixDQUE2QixXQUE3QjtFQXhFZSxDQUFqQjtBQWJpQixFQXpFd0I7OztBQW9LM0MsTUFBQSxHQUFTLFFBQVEsQ0FBQyxnQkFBVCxDQUEwQiwwQkFBMUI7O0FBQ1QsaUJBQUEsR0FBb0IsUUFBUSxDQUFDLGFBQVQsQ0FBdUIsK0JBQXZCOztBQUNwQixRQUFBLEdBQVcsUUFBUSxDQUFDLGFBQVQsQ0FBdUIsNEJBQXZCOztBQUNYLFVBQUEsR0FBYTs7QUFDYixTQUFBLEdBQVk7O0FBQ1osU0FBQSxHQUFZLEdBeksrQjs7QUEySzNDLGFBQUEsR0FBZ0IsT0EzSzJCOztBQTRLM0MsZ0JBQUEsR0FBbUIsR0E1S3dCOztBQTZLM0MsYUFBQSxHQUFnQixFQTdLMkI7O0FBZ0wzQyxVQUFBLEdBQWEsUUFBQSxDQUFDLFlBQVksT0FBYixDQUFBO0FBQ2IsTUFBQSxjQUFBLEVBQUEsV0FBQSxFQUFBLGdCQUFBLEVBQUE7RUFBRSxXQUFBLEdBQWMsUUFBUSxDQUFDLGdCQUFULENBQTBCLDJCQUExQixDQUFzRCxDQUFDLE9BQXZFO0VBQ0UsY0FBQSxHQUFpQixpQkFBaUIsQ0FBQyxZQURyQzs7O0FBSUUsVUFBTyxJQUFQO0FBQUEsU0FDTyxjQUFBLEdBQWlCLEdBRHhCO01BRUksYUFBQSxHQUFnQjtBQURiO0FBRFAsU0FHTyxjQUFBLEdBQWlCLEdBSHhCO01BSUksYUFBQSxHQUFnQjtBQURiO0FBSFAsU0FLTyxjQUFBLEdBQWlCLEdBTHhCO01BTUksYUFBQSxHQUFnQjtBQURiO0FBTFAsU0FPTyxjQUFBLEdBQWlCLEdBUHhCO01BUUksYUFBQSxHQUFnQjtBQURiO0FBUFA7TUFVSSxhQUFBLEdBQWdCO0FBVnBCLEdBSkY7O0VBaUJFLGdCQUFBLEdBQW1CLFdBQUEsR0FBYyxhQUFkLEdBQThCLGFBQTlCLEdBQThDO0VBRWpFLElBQUcsU0FBQSxLQUFhLE9BQWhCO0lBQ0UsSUFBRyxnQkFBQSxHQUFtQixhQUF0QjtNQUNFLGFBQUEsR0FBZ0IsaUJBQXRCO01BQ00sU0FBQSxHQUFZLEtBRmQ7S0FERjs7RUFLQSxVQUFBLEdBQWEsU0FBQSxHQUFZLGNBeEIzQjtFQTBCRSxJQUFHLFNBQUEsS0FBYSxPQUFoQjtJQUNFLGdCQUFBLElBQW9CO0lBQ3BCLGFBQUEsSUFBaUI7SUFFakIsSUFBRyxTQUFBLElBQWMsZ0JBQUEsS0FBb0IsQ0FBckM7TUFDRSxnQkFBQSxHQUFtQixDQUFDLENBQUQsR0FBSyxTQUFMLEdBQWlCLFdBQWpCLEdBQStCLGNBQS9CLEdBQWdELEdBRHJFOztJQUdBLElBQUcsVUFBSDtNQUNFLGdCQUFBLElBQW9CO01BQ3BCLGdCQUFBLElBQW9CO01BQ3BCLFVBQUEsR0FBYSxNQUhmO0tBUEY7R0FBQSxNQUFBO0lBWUUsZ0JBQUEsSUFBb0I7SUFDcEIsYUFBQSxJQUFpQjtJQUVqQixJQUFHLGFBQUEsSUFBaUIsQ0FBcEI7TUFDRSxnQkFBQSxHQUFtQixHQUF6QjtNQUNNLGFBQUEsR0FBZ0I7TUFDaEIsVUFBQSxHQUFhLEtBSGY7O0lBS0EsSUFBRyxTQUFIO01BQ0UsU0FBQSxHQUFZLE1BRGQ7S0FwQkY7O0VBdUJBLFFBQVEsQ0FBQyxLQUFLLENBQUMsSUFBZixHQUFzQixnQkFBZ0IsQ0FBQyxRQUFqQixDQUFBLENBQUEsR0FBOEI7QUFsRHpDOztBQXFEYixLQUFLLENBQUMsSUFBTixDQUFXLE1BQVgsQ0FBa0IsQ0FBQyxPQUFuQixDQUEyQixRQUFBLENBQUMsSUFBRCxDQUFBO0VBQ3pCLElBQUksQ0FBQyxnQkFBTCxDQUFzQixPQUF0QixFQUErQixRQUFBLENBQUMsS0FBRCxDQUFBO0lBQzdCLElBQUcsS0FBSyxDQUFDLE1BQU0sQ0FBQyxhQUFhLENBQUMsU0FBUyxDQUFDLFFBQXJDLENBQThDLCtCQUE5QyxDQUFIO01BQ0UsVUFBQSxDQUFBLEVBREY7S0FBQSxNQUFBO01BR0UsVUFBQSxDQUFXLE1BQVgsRUFIRjs7RUFENkIsQ0FBL0I7QUFEeUIsQ0FBM0IsRUFyTzJDOzs7QUFnUDNDLFdBQUEsQ0FBWSxrQkFBWiIsImZpbGUiOiJzY3JpcHQuanMiLCJzb3VyY2VzQ29udGVudCI6WyIjINCk0YPQvdC60YbQuNGPINC00LvRjyDRg9C/0YDQvtGJ0LXQvdC40Y8g0YHQvtC30LTQsNC90LjQtSDRjdC70LXQvNC10L3RgtC+0LIuXG5jcmVhdGVFbGVtID0gKHRhZywgZWxlbUNsYXNzKSAtPlxuICBlbGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCh0YWcpXG4gIGVsZW0uY2xhc3NMaXN0LmFkZCBlbGVtQ2xhc3NcbiAgZWxlbSBcblxuIyDQl9C00LXRgdGMINC90YPQttC90L4g0LHRg9C00LXRgiDQv9C+0LTRgtGP0LPQuNCy0LDRgtGMINCw0LrRgtGD0LDQu9GM0L3Rg9GOINC00LDRgtGDLlxudG9kYXlEYXRlID0gJzIwMjAtMDUtMjUnXG5cbiMg0J7QsdGA0LDRidCw0LXQvNGB0Y8g0LoganNvbi3RhNCw0LnQu9GDXG5yZWZlclRvSnNvbiA9IChjYWxsYmFjaykgLT5cbiAgZmV0Y2goJ3Rlc3QuanNvbicsIG1ldGhvZDogJ2dldCcpLnRoZW4oKHJlc3BvbnNlKSAtPlxuICAgIHJlc3BvbnNlLmpzb24oKVxuICApLnRoZW4oKHNjaGVkdWxlKSAtPlxuICAgIGNhbGxiYWNrIHNjaGVkdWxlXG4gICkuY2F0Y2ggKGVycikgLT5cbiAgICBjb25zb2xlLmxvZyBlcnJcbiAgcmV0dXJuXG5cbmNyZWF0ZVNjaGVkdWxlTGlzdCA9IChzY2hlZHVsZSkgLT5cbiAgc2NoZWR1bGVDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudHYtd2lkZ2V0X19zY2hlZHVsZS1pdGVtcycpXG5cbiAgIyDQodC+0LfQtNCw0ZHQvCDRgNCw0YHQv9C40YHQsNC90LjQtSBcbiAgZm9yIGtleSBvZiBzY2hlZHVsZVxuICAgIG1vbWVudC5sb2NhbGUgJ3J1J1xuICAgIGRhdGUgPSBtb21lbnQoa2V5KVxuICAgIGRheU51bWJlciA9IGRhdGUuZm9ybWF0KCdERCcpXG4gICAgbW91bnRoID0gZGF0ZS5mb3JtYXQoJ01NTU0nKVxuICAgIGRheVdlZWsgPSBkYXRlLmZvcm1hdCgnZGQnKVxuICAgIHNjaGVkdWxlSXRlbSA9IGNyZWF0ZUVsZW0oJ2RpdicsICd0di13aWRnZXRfX3NjaGVkdWxlLWl0ZW0nKVxuICAgIHNjaGVkdWxlSXRlbS5kYXRhc2V0LmRhdGUgPSBrZXlcbiAgICBcbiAgICBpZiBkYXlXZWVrID09ICfRgdCxJyBvciBkYXlXZWVrID09ICfQstGBJ1xuICAgICAgc2NoZWR1bGVJdGVtLmNsYXNzTGlzdC5hZGQgJ3R2LXdpZGdldF9fc2NoZWR1bGUtaXRlbV93ZWVrZW5kJ1xuICAgIGVsc2UgaWYgZGF5V2VlayA9PSAn0L/RgidcbiAgICAgIHNjaGVkdWxlSXRlbS5jbGFzc0xpc3QuYWRkICd0di13aWRnZXRfX3NjaGVkdWxlLWl0ZW1fZnJpZGF5J1xuICAgICAgXG4gICAgc2NoZWR1bGVEYXkgPSBjcmVhdGVFbGVtKCdkaXYnLCAndHYtd2lkZ2V0X19kYXknKVxuICAgIHNjaGVkdWxlRGF5LnRleHRDb250ZW50ID0gZGF5TnVtYmVyXG5cbiAgICBzY2hlZHVsZU1vdW50aCA9IGNyZWF0ZUVsZW0oJ2RpdicsICd0di13aWRnZXRfX21vdW50aCcpXG4gICAgc2NoZWR1bGVNb3VudGgudGV4dENvbnRlbnQgPSBtb3VudGhcblxuICAgIHNjaGVkdWxlTGluZSA9IGNyZWF0ZUVsZW0oJ2RpdicsICd0di13aWRnZXRfX2xpbmUnKVxuXG4gICAgc2NoZWR1bGVXZWVrZGF5ID0gY3JlYXRlRWxlbSgnZGl2JywgJ3R2LXdpZGdldF9fd2Vla2RheScpXG4gICAgc2NoZWR1bGVXZWVrZGF5LnRleHRDb250ZW50ID0gZGF5V2Vla1xuXG4gICAgc2NoZWR1bGVJdGVtLmFwcGVuZENoaWxkIHNjaGVkdWxlRGF5XG4gICAgc2NoZWR1bGVJdGVtLmFwcGVuZENoaWxkIHNjaGVkdWxlTW91bnRoXG4gICAgc2NoZWR1bGVJdGVtLmFwcGVuZENoaWxkIHNjaGVkdWxlTGluZVxuICAgIHNjaGVkdWxlSXRlbS5hcHBlbmRDaGlsZCBzY2hlZHVsZVdlZWtkYXlcblxuICAgIHNjaGVkdWxlQ29udGFpbmVyLmFwcGVuZENoaWxkIHNjaGVkdWxlSXRlbVxuXG4gICMg0J7QsdC90L7QstC70Y/QtdC8INGN0LvQtdC80LXQvdGC0Ysg0L/RgNC4INC30LDQs9GA0YPQt9C60LUg0YHRgtGA0LDQvdC40YbRi1xuICB1cGRhdGVEYXlQcm9ncmFtIHRvZGF5RGF0ZSwgc2NoZWR1bGVbdG9kYXlEYXRlXVxuXG4gICMg0KDQtdCz0LjRgdGC0YDQuNGA0YPQtdC8INGB0L7QsdGL0YLQuNGPXG4gIHJlZ2lzdGVyRXZlbnRzID0gLT5cbiAgICBzY2hlZHVsZURheXMgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy50di13aWRnZXRfX3NjaGVkdWxlLWl0ZW0nKSlcbiAgICBzY2hlZHVsZURheXMuZm9yRWFjaCAoaXRlbSkgLT5cbiAgICAgIGl0ZW0uYWRkRXZlbnRMaXN0ZW5lciAnY2xpY2snLCAoZXZlbnQpIC0+XG4gICAgICAgIGVsZW0gPSBldmVudC50YXJnZXQuY2xvc2VzdCgnLnR2LXdpZGdldF9fc2NoZWR1bGUtaXRlbScpXG4gICAgICAgIHVwZGF0ZURheVByb2dyYW0gZWxlbS5nZXRBdHRyaWJ1dGUoJ2RhdGEtZGF0ZScpLCBzY2hlZHVsZVtlbGVtLmdldEF0dHJpYnV0ZSgnZGF0YS1kYXRlJyldXG4gICAgICAgIHJldHVyblxuICAgICAgcmV0dXJuXG4gICAgcmV0dXJuXG5cbiAgcmVnaXN0ZXJFdmVudHMoKVxuICByZXR1cm5cblxuIyDQntCx0L3QvtCy0LvRj9C10Lwg0Y3Qu9C10LzQtdC90YLRiyDRgNCw0YHQv9C40YHQsNC90LjRjyDQv9C+0LQg0LrQsNC70LXQvdC00LDRgNGR0LxcbnVwZGF0ZURheVByb2dyYW0gPSAoZGF0ZSwgc2NoZWR1bGUpIC0+XG4gIHdpZGdldFRpdGxlU3BhbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50dl93aWRnZXRfX3RvZGF5LWRhdGUnKVxuICB3aWRnZXRUaXRsZVNwYW5UZXh0ID0gbW9tZW50KGRhdGUpLmZvcm1hdCgnZGRkZCwgREQgTU1NTSBZWVlZJylcblxuICBpZiBkYXRlID09IHRvZGF5RGF0ZVxuICAgIHdpZGdldFRpdGxlU3Bhbi50ZXh0Q29udGVudCA9ICcg0L3QsCDRgdC10LPQvtC00L3RjydcbiAgZWxzZVxuICAgIHdpZGdldFRpdGxlU3Bhbi50ZXh0Q29udGVudCA9ICcnXG4gIHdpZGdldFRpdGxlU3Bhbi50ZXh0Q29udGVudCArPSAnLiAnICsgd2lkZ2V0VGl0bGVTcGFuVGV4dFswXS50b1VwcGVyQ2FzZSgpICsgd2lkZ2V0VGl0bGVTcGFuVGV4dC5zbGljZSgxKVxuXG4gIHByb2dyYW1Db250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudHYtd2lkZ2V0X19wcm9ncmFtLWNhcmRzJylcbiAgcHJvZ3JhbUNvbnRhaW5lci5pbm5lckhUTUwgPSAnJ1xuXG4gIHNjaGVkdWxlLmZvckVhY2ggKGl0ZW0sIGluZGV4KSAtPlxuICAgIHByb2dyYW1DYXJkID0gY3JlYXRlRWxlbSgnZGl2JywgJ3R2LXdpZGdldF9fcHJvZ3JhbS1jYXJkJylcbiAgICB0aXRsZUJsb2NrID0gY3JlYXRlRWxlbSgnZGl2JywgJ3R2LXdpZGdldF9fcHJvZ3JhbS10aXRsZS1ibG9jaycpXG4gICAgcHJvZ3JhbVRpbWUgPSBjcmVhdGVFbGVtKCdkaXYnLCAndHYtd2lkZ2V0X19wcm9ncmFtLXRpbWUnKVxuICAgIHByb2dyYW1UaW1lLnRleHRDb250ZW50ID0gaXRlbS50aW1lXG4gICAgcHJvZ3JhbVRpdGxlID0gY3JlYXRlRWxlbSgnYScsICd0di13aWRnZXRfX3Byb2dyYW0tdGl0bGUnKVxuICAgIHByb2dyYW1UaXRsZS5ocmVmID0gJyMnXG4gICAgcHJvZ3JhbVRpdGxlLnRleHRDb250ZW50ID0gaXRlbS50aXRsZVxuICAgIGF3YXJkcyA9IGNyZWF0ZUVsZW0oJ2RpdicsICd0di13aWRnZXRfX3Byb2dyYW0tYXdhcmRzJylcbiAgICBcbiAgICBmb3Iga2V5IG9mIGl0ZW0uYXdhcmRzXG4gICAgICBpZiBpdGVtLmF3YXJkc1trZXldID09ICd0cnVlJ1xuICAgICAgICBhd2FyZCA9IGNyZWF0ZUVsZW0oJ2RpdicsICd0di13aWRnZXRfX3Byb2dyYW0tYXdhcmQnKVxuICAgICAgICBhd2FyZC5jbGFzc0xpc3QuYWRkICd0di13aWRnZXRfX3Byb2dyYW0tYXdhcmRfJyArIGtleVxuICAgICAgICBhd2FyZHMuYXBwZW5kQ2hpbGQgYXdhcmRcblxuICAgIHByb2dyYW1Db3VudHJ5ID0gY3JlYXRlRWxlbSgnZGl2JywgJ3R2LXdpZGdldF9fcHJvZ3JhbS1jb3VudHJ5JylcblxuICAgIGNvdW50cnlJbWcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbWcnKVxuICAgIGNvdW50cnlJbWcuc3JjID0gJ2ltZy9pY29ucy9ydXNzaWEtaWNvbi5zdmcnXG4gICAgY291bnRyeUltZy5hbHQgPSBpdGVtLmNvdW50cnlcbiAgICBcbiAgICBwcm9ncmFtQ291bnRyeS5hcHBlbmRDaGlsZCBjb3VudHJ5SW1nXG4gICAgdHZDaGFubmVsID0gY3JlYXRlRWxlbSgnZGl2JywgJ3R2LXdpZGdldF9fcHJvZ3JhbS1jaGFubmVsJylcbiAgICBcbiAgICBjaGFubmVsSW1nID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJylcbiAgICBjaGFubmVsSW1nLnNyYyA9ICdpbWcvaWNvbnMvMXR2LWljb24uc3ZnJ1xuICAgIGNoYW5uZWxJbWcuYWx0ID0gaXRlbS5jaGFubmVsXG5cbiAgICB0dkNoYW5uZWwuYXBwZW5kQ2hpbGQgY2hhbm5lbEltZ1xuICAgIHRpdGxlQmxvY2suYXBwZW5kQ2hpbGQgcHJvZ3JhbVRpbWVcbiAgICB0aXRsZUJsb2NrLmFwcGVuZENoaWxkIHByb2dyYW1UaXRsZVxuICAgIHRpdGxlQmxvY2suYXBwZW5kQ2hpbGQgYXdhcmRzXG5cbiAgICBpZiBpdGVtLmNvdW50cnlcbiAgICAgIHRpdGxlQmxvY2suYXBwZW5kQ2hpbGQgcHJvZ3JhbUNvdW50cnlcblxuICAgIHRpdGxlQmxvY2suYXBwZW5kQ2hpbGQgdHZDaGFubmVsXG5cbiAgICBwcm9ncmFtRGVzY3JpcHRpb24gPSBjcmVhdGVFbGVtKCdkaXYnLCAndHYtd2lkZ2V0X19wcm9ncmFtLWRlc2NyaXB0aW9uJylcbiAgICBwcm9ncmFtRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSBpdGVtLmRlc2NyaXB0aW9uXG5cbiAgICBwcm9ncmFtQXJ0aXN0cyA9IGNyZWF0ZUVsZW0oJ2RpdicsICd0di13aWRnZXRfX3Byb2dyYW0tYXJ0aXN0cycpXG5cbiAgICBpdGVtLmFydGlzdHMuZm9yRWFjaCAoYXJ0aXN0TmFtZSwgaW5kZXgpIC0+XG4gICAgICBhcnRpc3RFbGVtID0gY3JlYXRlRWxlbSgnYScsICd0di13aWRnZXRfX3Byb2dyYW0tYXJ0aXN0JylcbiAgICAgIGFydGlzdEVsZW0uaHJlZiA9ICcjJ1xuICAgICAgYXJ0aXN0RWxlbS50ZXh0Q29udGVudCA9IGFydGlzdE5hbWVcbiAgICAgIHByb2dyYW1BcnRpc3RzLmFwcGVuZENoaWxkIGFydGlzdEVsZW1cblxuICAgICAgaWYgaW5kZXggIT0gaXRlbS5hcnRpc3RzLmxlbmd0aCAtIDFcbiAgICAgICAgcHJvZ3JhbUFydGlzdHMuaW5uZXJIVE1MICs9ICcsICdcbiAgICAgIHJldHVyblxuICAgICAgXG4gICAgcHJvZ3JhbUNhcmQuYXBwZW5kQ2hpbGQgdGl0bGVCbG9ja1xuICAgIHByb2dyYW1DYXJkLmFwcGVuZENoaWxkIHByb2dyYW1EZXNjcmlwdGlvblxuICAgIHByb2dyYW1DYXJkLmFwcGVuZENoaWxkIHByb2dyYW1BcnRpc3RzXG5cbiAgICAjINCi0YPRgiDQvdGD0LbQvdC+INGD0LrQsNC30LDRgtGMINGC0LXQutGD0YnQuNC1INCy0YDQtdC80Y8g0Lgg0LTQsNGC0YMuINCY0YHQv9C+0LvRjNC30YPQtdGC0YHRjyDQtNC70Y8g0L/QvtC60LDQt9CwINC60L3QvtC/0L7QuiBcItCh0LzQvtGC0YDQtdGC0YxcIiDQuCBcItCh0LXQudGH0LDRgSDQsiDRjdGE0LjRgNC1XCJcbiAgICBpZiBtb21lbnQoZGF0ZSkuZm9ybWF0KCdMJykgPT0gbW9tZW50KHRvZGF5RGF0ZSkuZm9ybWF0KCdMJykgYW5kIGl0ZW0udGltZSA9PSAnMTA6NTknXG5cbiAgICAgIGJ1dHRvbkJsb2NrID0gY3JlYXRlRWxlbSgnZGl2JywgJ3R2LXdpZGdldF9fYnV0dG9uLWJsb2NrJylcbiAgICAgIGJ1dHRvbiA9IGNyZWF0ZUVsZW0oJ2RpdicsICdsb29rLWJ1dHRvbicpXG4gICAgICBidXR0b24udGV4dENvbnRlbnQgPSAn0KHQvNC+0YLRgNC10YLRjCdcblxuICAgICAgbGl2ZVRpdGxlID0gY3JlYXRlRWxlbSgnZGl2JywgJ3R2LXdpZGdldF9fbGlmZS1ub3cnKVxuICAgICAgbGl2ZVRpdGxlLnRleHRDb250ZW50ID0gJ9Ch0LXQudGH0LDRgSDQsiDRjdGE0LjRgNC1J1xuXG4gICAgICBidXR0b25CbG9jay5hcHBlbmRDaGlsZCBidXR0b25cbiAgICAgIGJ1dHRvbkJsb2NrLmFwcGVuZENoaWxkIGxpdmVUaXRsZVxuICAgICAgcHJvZ3JhbUNhcmQuYXBwZW5kQ2hpbGQgYnV0dG9uQmxvY2tcblxuICAgIHByb2dyYW1Db250YWluZXIuYXBwZW5kQ2hpbGQgcHJvZ3JhbUNhcmRcbiAgICByZXR1cm5cbiAgcmV0dXJuXG5cblxuIyDRgdC70LDQudC00LXRgFxuYXJyb3dzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnR2LXdpZGdldF9fYXJyb3ctY2lyY2xlJylcbmNhcm91c2VsQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnR2LXdpZGdldF9fc2NoZWR1bGUtY29yb3VzZWwnKVxuY2Fyb3VzZWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudHYtd2lkZ2V0X19zY2hlZHVsZS1pdGVtcycpXG5maXJzdFNsaWRlID0gdHJ1ZVxubGFzdFNsaWRlID0gZmFsc2Vcbml0ZW1XaWR0aCA9IDg0ICMg0KjQuNGA0LjQvdCwINGN0LvQtdC80LXQvdGC0LBcblxubnVtYmVyT2ZTdGVwcyA9IHVuZGVmaW5lZCAjINCa0L7Qu9C40YfQtdGB0YLQstC+INGI0LDQs9C+0LIsINC60L7RgtC+0YDQvtC1INC/0YDQtdC00YHRgtC+0LjRgiDRgdC00LXQu9Cw0YLRjCBcbmN1cnJlbnRTdGVwV2lkdGggPSA2MCAjINCY0LfQvdCw0YfQsNC70YzQvdC+0LUg0L7RgdGC0L7Rj9C90LjQtSBsZWZ0IFxuaXRlbXNTY3JvbGxlZCA9IDAgI9Ca0L7Qu9C40YfQtdGB0YLQstC+INGN0LvQtdC80LXQvdGC0L7Qsiwg0LrQvtGC0L7RgNGL0LUg0LzRiyDRgdC60YDQvtC70LvQuNC8XG5cblxucHVzaFNsaWRlciA9IChkaXJlY3Rpb24gPSAncmlnaHQnKSAtPlxuICBpdGVtc051bWJlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy50di13aWRnZXRfX3NjaGVkdWxlLWl0ZW0nKS5sZW5ndGggIyDQntCx0YnQtdC1INC60L7Qu9C40YfQtdGB0YLQstC+INGN0LvQtdC80LXQvdGC0L7QslxuICBjb250YWluZXJXaWR0aCA9IGNhcm91c2VsQ29udGFpbmVyLm9mZnNldFdpZHRoICMg0KjQuNGA0LjQvdCwINC60L7QvdGC0LXQudC90LXRgNCwXG4gXG4gICMg0JIg0LfQsNCy0LjRgdC40LzQvtGB0YLQuCDQvtGCINGI0LjRgNC40L3RiyDQutC+0L3RgtC10LnQvdC10YDQsCDQvtC/0YDQtdC00LXQu9GP0LXQvCwg0YHQutC+0LvRjNC60L4g0Y3Qu9C10LzQtdC90YLQvtCyINC90LDQtNC+INC/0YDQvtC60YDRg9GC0LjRgtGMXG4gIHN3aXRjaCB0cnVlXG4gICAgd2hlbiBjb250YWluZXJXaWR0aCA8IDM2MFxuICAgICAgbnVtYmVyT2ZTdGVwcyA9IDFcbiAgICB3aGVuIGNvbnRhaW5lcldpZHRoIDwgNDIwXG4gICAgICBudW1iZXJPZlN0ZXBzID0gMlxuICAgIHdoZW4gY29udGFpbmVyV2lkdGggPCA1MDVcbiAgICAgIG51bWJlck9mU3RlcHMgPSAzXG4gICAgd2hlbiBjb250YWluZXJXaWR0aCA8IDU4NVxuICAgICAgbnVtYmVyT2ZTdGVwcyA9IDRcbiAgICBlbHNlXG4gICAgICBudW1iZXJPZlN0ZXBzID0gNVxuXG4gICMg0J7Qv9GA0LXQtNC10LvRj9C10LwsINGB0LrQvtC70YzQutC+INGN0LvQtdC80LXQvdGC0L7QsiDQv9GA0LXQtNGB0YLQvtC40YLRjCDQv9GA0L7QutGA0YPRgtC40YLRjC4gXG4gIHJlbWFpbmVkVG9TY3JvbGwgPSBpdGVtc051bWJlciAtIGl0ZW1zU2Nyb2xsZWQgLSBudW1iZXJPZlN0ZXBzIC0gMlxuXG4gIGlmIGRpcmVjdGlvbiA9PSAncmlnaHQnXG4gICAgaWYgcmVtYWluZWRUb1Njcm9sbCA8IG51bWJlck9mU3RlcHMgIyDQldGB0LvQuCDQutC+0LvQuNGH0LXRgdGC0LLQviDRjdC70LXQvNC10L3RgtC+0LIsINGB0LrQvtC70YzQutC+INC80L7QttC90L4g0L/RgNC+0LrRgNGD0YLQuNGC0YwsINC80LXQvdGM0YjQtSDQutC+0LvQuNGH0LXRgdGC0LLQsCDRiNCw0LPQvtCyXG4gICAgICBudW1iZXJPZlN0ZXBzID0gcmVtYWluZWRUb1Njcm9sbCAjINCT0L7QstC+0YDQuNC8LCDRgdC60L7Qu9GM0LrQviDRiNCw0LPQvtCyINC/0YDQvtC60YDRg9GH0LjQstCw0LXQvFxuICAgICAgbGFzdFNsaWRlID0gdHJ1ZSAjINCe0L/RgNC10LTQtdC70Y/QtdC8LCDRh9GC0L4g0YHQu9Cw0LnQtCDQv9C+0YHQu9C10LTQvdC40LlcblxuICBzbGlkZVdpZHRoID0gaXRlbVdpZHRoICogbnVtYmVyT2ZTdGVwcyAgIyDQntC/0YDQtdC00LXQu9GP0LXQvCDRiNC40YDQuNC90YMg0YHQu9Cw0LnQtNCwICjQvdCw0YHQutC+0LvRjNC60L4g0L3Rg9C20L3QviDQv9GA0L7QutGA0YPRgtC40YLRjClcblxuICBpZiBkaXJlY3Rpb24gPT0gJ3JpZ2h0J1xuICAgIGN1cnJlbnRTdGVwV2lkdGggLT0gc2xpZGVXaWR0aFxuICAgIGl0ZW1zU2Nyb2xsZWQgKz0gbnVtYmVyT2ZTdGVwc1xuXG4gICAgaWYgbGFzdFNsaWRlIGFuZCByZW1haW5lZFRvU2Nyb2xsICE9IDBcbiAgICAgIGN1cnJlbnRTdGVwV2lkdGggPSAtMSAqIGl0ZW1XaWR0aCAqIGl0ZW1zTnVtYmVyICsgY29udGFpbmVyV2lkdGggLSA0MFxuICAgICAgXG4gICAgaWYgZmlyc3RTbGlkZVxuICAgICAgY3VycmVudFN0ZXBXaWR0aCArPSBpdGVtV2lkdGhcbiAgICAgIGN1cnJlbnRTdGVwV2lkdGggLT0gNjBcbiAgICAgIGZpcnN0U2xpZGUgPSBmYWxzZVxuICBlbHNlICMg0JXRgdC70Lgg0L/RgNC+0LrRgNGD0YfQuNCy0LDQtdC8INCy0LvQtdCy0L5cbiAgICBjdXJyZW50U3RlcFdpZHRoICs9IHNsaWRlV2lkdGhcbiAgICBpdGVtc1Njcm9sbGVkIC09IG51bWJlck9mU3RlcHNcblxuICAgIGlmIGl0ZW1zU2Nyb2xsZWQgPD0gMFxuICAgICAgY3VycmVudFN0ZXBXaWR0aCA9IDYwICMg0LLQvtC30LLRgNCw0YnQsNC10LzRgdGPINCyINC40LfQvdCw0YfQsNC70YzQvdGOINC/0LXRgNCy0YPRjiDQv9C+0LfQuNGG0LjRjlxuICAgICAgaXRlbXNTY3JvbGxlZCA9IDBcbiAgICAgIGZpcnN0U2xpZGUgPSB0cnVlIFxuXG4gICAgaWYgbGFzdFNsaWRlXG4gICAgICBsYXN0U2xpZGUgPSBmYWxzZVxuXG4gIGNhcm91c2VsLnN0eWxlLmxlZnQgPSBjdXJyZW50U3RlcFdpZHRoLnRvU3RyaW5nKCkgKyAncHgnXG4gIHJldHVyblxuXG5BcnJheS5mcm9tKGFycm93cykuZm9yRWFjaCAoaXRlbSkgLT5cbiAgaXRlbS5hZGRFdmVudExpc3RlbmVyICdjbGljaycsIChldmVudCkgLT5cbiAgICBpZiBldmVudC50YXJnZXQucGFyZW50RWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ3R2LXdpZGdldF9fYXJyb3ctY2lyY2xlX3JpZ2h0JylcbiAgICAgIHB1c2hTbGlkZXIoKVxuICAgIGVsc2VcbiAgICAgIHB1c2hTbGlkZXIgJ2xlZnQnXG4gICAgcmV0dXJuXG4gIHJldHVyblxuXG5cbiMg0KHQvtC30LTQsNGR0Lwg0LrQsNC70LXQvdC00LDRgNGMXG5yZWZlclRvSnNvbiBjcmVhdGVTY2hlZHVsZUxpc3QiXX0=
